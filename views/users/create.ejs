<div class="form-container">
    <div class="form-header">
        <h2>Add New User</h2>
        <p>Create a new administrative or standard user account.</p>
    </div>

    <% if (typeof errors !=='undefined' && errors.length> 0) { %>
        <div class="alert alert-error">
            <ul style="margin-left: 1.5rem;">
                <% errors.forEach(error=> { %>
                    <li>
                        <%= error.msg %>
                    </li>
                    <% }) %>
            </ul>
        </div>
        <% } %>

            <form action="/users" method="POST" enctype="multipart/form-data">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input type="text" name="username" class="form-control"
                            value="<%= typeof formData !== 'undefined' ? formData.username : '' %>" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" name="email" class="form-control"
                            value="<%= typeof formData !== 'undefined' ? formData.email : '' %>" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" name="password" class="form-control" required>
                        <small class="form-text">Min. 6 characters with at least one number.</small>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" name="full_name" class="form-control"
                            value="<%= typeof formData !== 'undefined' ? formData.full_name : '' %>" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Phone Number</label>
                        <input type="text" name="phone" class="form-control"
                            value="<%= typeof formData !== 'undefined' ? formData.phone : '' %>">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Role</label>
                        <select name="role" class="form-control" required>
                            <option value="user">Standard User</option>
                            <option value="manager">Manager</option>
                            <option value="admin">Administrator</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Profile Avatar</label>
                    <div class="file-upload" onclick="document.getElementById('avatar-input').click()">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Click to upload or drag and drop</p>
                        <p style="font-size: 0.8rem; color: var(--gray);">PNG, JPG up to 2MB</p>
                        <input type="file" id="avatar-input" name="avatar" class="file-input" accept="image/*">
                    </div>
                    <div id="file-name" style="margin-top: 5px; font-size: 0.9rem; color: var(--primary);"></div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Create User</button>
                    <a href="/users" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
</div>

<script>
    document.getElementById('avatar-input').addEventListener('change', function (e) {
        const fileName = e.target.files[0] ? e.target.files[0].name : '';
        document.getElementById('file-name').textContent = fileName ? `Selected: ${fileName}` : '';
    });
</script>