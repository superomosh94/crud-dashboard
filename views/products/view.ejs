<div class="form-container">
    <div class="form-header" style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
            <h2>Product Details</h2>
            <p>Full information about <%= product.name %>.</p>
        </div>
        <div class="table-actions">
            <% if (user.role==='admin' || user.role==='manager' ) { %>
                <a href="/products/<%= product.id %>/edit" class="btn btn-primary">
                    <i class="fas fa-edit"></i> Edit Product
                </a>
                <% } else if (product.status==='active' && product.quantity> 0) { %>
                    <a href="/orders/create?product_id=<%= product.id %>" class="btn btn-primary"
                        style="background: var(--success); border-color: var(--success);">
                        <i class="fas fa-shopping-cart"></i> Purchase Now
                    </a>
                    <% } %>
                        <a href="/products" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Back to List
                        </a>
        </div>
    </div>

    <div style="display: flex; gap: var(--space-xl); margin-top: var(--space-lg); flex-wrap: wrap;">
        <div style="flex: 0 0 300px;">
            <div
                style="width: 100%; aspect-ratio: 1; background: var(--gray-light); border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-sm);">
                <% if (product.image) { %>
                    <img src="<%= product.image %>" alt="Product" style="width: 100%; height: 100%; object-fit: cover;">
                    <% } else { %>
                        <i class="fas fa-box"
                            style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--gray); font-size: 5rem;"></i>
                        <% } %>
            </div>
            <% if (product.featured) { %>
                <div style="margin-top: var(--space-sm); text-align: center;">
                    <span class="badge badge-info" style="font-size: 0.9rem; padding: 6px 16px;"><i
                            class="fas fa-star"></i> Featured Product</span>
                </div>
                <% } %>
        </div>

        <div style="flex: 1; min-width: 300px;">
            <div class="stat-card" style="margin-bottom: var(--space-md);">
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md); border-bottom: 1px solid var(--gray-light); padding-bottom: 10px;">
                    <h3 style="margin: 0;">
                        <%= product.name %>
                    </h3>
                    <span class="badge badge-<%= product.status === 'active' ? 'success' : 'danger' %>">
                        <%= product.status.replace(/_/g, ' ' ) %>
                    </span>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
                    <div>
                        <label style="font-weight: 600; font-size: 0.85rem; color: var(--gray);">SKU</label>
                        <p style="font-size: 1.1rem; margin-top: 4px;"><code><%= product.sku %></code></p>
                    </div>
                    <div>
                        <label style="font-weight: 600; font-size: 0.85rem; color: var(--gray);">CATEGORY</label>
                        <p style="font-size: 1.1rem; margin-top: 4px;">
                            <%= product.category ? product.category.name : 'Uncategorized' %>
                        </p>
                    </div>
                    <div>
                        <label style="font-weight: 600; font-size: 0.85rem; color: var(--gray);">SELLING PRICE</label>
                        <p style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">KSh <%= product.price %>
                        </p>
                    </div>
                    <div>
                        <label style="font-weight: 600; font-size: 0.85rem; color: var(--gray);">STOCK LEVEL</label>
                        <p
                            style="font-size: 1.5rem; font-weight: 700; color: <%= product.quantity <= 10 ? 'var(--danger)' : 'var(--success)' %>;">
                            <%= product.quantity %> units
                        </p>
                    </div>
                </div>
            </div>

            <div class="stat-card">
                <h4 style="color: var(--gray); margin-bottom: var(--space-sm); font-size: 0.9rem;">DESCRIPTION</h4>
                <p style="white-space: pre-line; color: var(--dark); line-height: 1.6;">
                    <%= product.description || 'No description provided.' %>
                </p>
            </div>

            <% if (user.role==='admin' || user.role==='manager' ) { %>
                <div class="stat-card" style="margin-top: var(--space-md); background: var(--light);">
                    <div style="display: flex; gap: var(--space-xl);">
                        <div>
                            <label style="font-weight: 600; font-size: 0.85rem; color: var(--gray);">COST PRICE</label>
                            <p style="font-weight: 600;">KSh <%= product.cost_price %>
                            </p>
                        </div>
                        <div>
                            <label style="font-weight: 600; font-size: 0.85rem; color: var(--gray);">ESTIMATED
                                PROFIT</label>
                            <p style="font-weight: 600; color: var(--success);">KSh <%= (product.price -
                                    product.cost_price).toFixed(2) %> per unit</p>
                        </div>
                        <div>
                            <label style="font-weight: 600; font-size: 0.85rem; color: var(--gray);">MARGIN</label>
                            <p style="font-weight: 600;">
                                <%= product.price> 0 ? (((product.price - product.cost_price) / product.price) *
                                    100).toFixed(1) : 0 %>%
                            </p>
                        </div>
                    </div>
                </div>
                <% } %>
        </div>
    </div>
</div>